"use strict";self.webpackHotUpdatereeval_screenity(471,{804:(t,e,r)=>{function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function o(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */o=function(){return e};var t,e={},r=Object.prototype,a=r.hasOwnProperty,i=Object.defineProperty||function(t,e,r){t[e]=r.value},c="function"==typeof Symbol?Symbol:{},u=c.iterator||"@@iterator",s=c.asyncIterator||"@@asyncIterator",l=c.toStringTag||"@@toStringTag";function f(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(t){f=function(t,e,r){return t[e]=r}}function h(t,e,r,n){var o=e&&e.prototype instanceof b?e:b,a=Object.create(o.prototype),c=new I(n||[]);return i(a,"_invoke",{value:T(t,r,c)}),a}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=h;var d="suspendedStart",v="suspendedYield",m="executing",y="completed",g={};function b(){}function w(){}function x(){}var k={};f(k,u,(function(){return this}));var E=Object.getPrototypeOf,L=E&&E(E(N([])));L&&L!==r&&a.call(L,u)&&(k=L);var _=x.prototype=b.prototype=Object.create(k);function O(t){["next","throw","return"].forEach((function(e){f(t,e,(function(t){return this._invoke(e,t)}))}))}function j(t,e){function r(o,i,c,u){var s=p(t[o],t,i);if("throw"!==s.type){var l=s.arg,f=l.value;return f&&"object"==n(f)&&a.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,c,u)}),(function(t){r("throw",t,c,u)})):e.resolve(f).then((function(t){l.value=t,c(l)}),(function(t){return r("throw",t,c,u)}))}u(s.arg)}var o;i(this,"_invoke",{value:function(t,n){function a(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(a,a):a()}})}function T(e,r,n){var o=d;return function(a,i){if(o===m)throw Error("Generator is already running");if(o===y){if("throw"===a)throw i;return{value:t,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var u=S(c,n);if(u){if(u===g)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=m;var s=p(e,r,n);if("normal"===s.type){if(o=n.done?y:v,s.arg===g)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=y,n.method="throw",n.arg=s.arg)}}}function S(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,S(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var a=p(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,g;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,g):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function A(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function N(e){if(e||""===e){var r=e[u];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(a.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(n(e)+" is not iterable")}return w.prototype=x,i(_,"constructor",{value:x,configurable:!0}),i(x,"constructor",{value:w,configurable:!0}),w.displayName=f(x,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,f(t,l,"GeneratorFunction")),t.prototype=Object.create(_),t},e.awrap=function(t){return{__await:t}},O(j.prototype),f(j.prototype,s,(function(){return this})),e.AsyncIterator=j,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new j(h(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},O(_),f(_,l,"Generator"),f(_,u,(function(){return this})),f(_,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=N,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(A),!e)for(var r in this)"t"===r.charAt(0)&&a.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],c=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var u=a.call(i,"catchLoc"),s=a.call(i,"finallyLoc");if(u&&s){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&a.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),A(r),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;A(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:N(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),g}},e}function a(t,e,r,n,o,a,i){try{var c=t[a](i),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}const i=function(){var t,e=(t=o().mark((function t(){var e;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,chrome.identity.getAuthToken({interactive:!0});case 3:if(e=t.sent){t.next=6;break}throw new Error("User cancelled sign-in or failed to get token");case 6:return t.next=8,new Promise((function(t){return chrome.storage.local.set({token:e.token},(function(){return t()}))}));case 8:return t.next=10,chrome.identity.getProfileUserInfo();case 10:return t.sent,t.abrupt("return",e.token);case 14:return t.prev=14,t.t0=t.catch(0),console.error("Error signing in:",t.t0.message),t.abrupt("return",null);case 19:case"end":return t.stop()}}),t,null,[[0,14]])})),function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function c(t){a(i,n,o,c,u,"next",t)}function u(t){a(i,n,o,c,u,"throw",t)}c(void 0)}))});return function(){return e.apply(this,arguments)}}();function c(t){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c(t)}function u(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */u=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function f(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(t){f=function(t,e,r){return t[e]=r}}function h(t,e,r,n){var a=e&&e.prototype instanceof b?e:b,i=Object.create(a.prototype),c=new I(n||[]);return o(i,"_invoke",{value:T(t,r,c)}),i}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=h;var d="suspendedStart",v="suspendedYield",m="executing",y="completed",g={};function b(){}function w(){}function x(){}var k={};f(k,i,(function(){return this}));var E=Object.getPrototypeOf,L=E&&E(E(N([])));L&&L!==r&&n.call(L,i)&&(k=L);var _=x.prototype=b.prototype=Object.create(k);function O(t){["next","throw","return"].forEach((function(e){f(t,e,(function(t){return this._invoke(e,t)}))}))}function j(t,e){function r(o,a,i,u){var s=p(t[o],t,a);if("throw"!==s.type){var l=s.arg,f=l.value;return f&&"object"==c(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,i,u)}),(function(t){r("throw",t,i,u)})):e.resolve(f).then((function(t){l.value=t,i(l)}),(function(t){return r("throw",t,i,u)}))}u(s.arg)}var a;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function T(e,r,n){var o=d;return function(a,i){if(o===m)throw Error("Generator is already running");if(o===y){if("throw"===a)throw i;return{value:t,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var u=S(c,n);if(u){if(u===g)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=m;var s=p(e,r,n);if("normal"===s.type){if(o=n.done?y:v,s.arg===g)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=y,n.method="throw",n.arg=s.arg)}}}function S(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,S(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var a=p(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,g;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,g):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function A(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function N(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(c(e)+" is not iterable")}return w.prototype=x,o(_,"constructor",{value:x,configurable:!0}),o(x,"constructor",{value:w,configurable:!0}),w.displayName=f(x,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,f(t,l,"GeneratorFunction")),t.prototype=Object.create(_),t},e.awrap=function(t){return{__await:t}},O(j.prototype),f(j.prototype,s,(function(){return this})),e.AsyncIterator=j,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new j(h(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},O(_),f(_,l,"Generator"),f(_,i,(function(){return this})),f(_,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=N,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(A),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var u=n.call(i,"catchLoc"),s=n.call(i,"finallyLoc");if(u&&s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,g):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),A(r),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;A(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:N(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),g}},e}function s(t,e,r,n,o,a,i){try{var c=t[a](i),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function l(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){s(a,n,o,i,c,"next",t)}function c(t){s(a,n,o,i,c,"throw",t)}i(void 0)}))}}const f=function(){var t=l(u().mark((function t(e,r,n){var o,a;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=function(){return a=l(u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,e){chrome.storage.local.get(["token"],function(){var r=l(u().mark((function r(n){var o,a,c,s;return u().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!chrome.runtime.lastError){r.next=4;break}e(new Error(chrome.runtime.lastError)),r.next=24;break;case 4:if((o=n.token)&&null!==o){r.next=13;break}return r.next=8,i();case 8:(a=r.sent)&&null!==a||e(new Error("Sign-in failed")),t(a),r.next=24;break;case 13:r.prev=13,c=JSON.parse(atob(o.split(".")[1])),r.next=21;break;case 17:return r.prev=17,r.t0=r.catch(13),chrome.identity.getAuthToken({interactive:!0},(function(r){chrome.runtime.lastError?e(new Error(chrome.runtime.lastError)):t(r)})),r.abrupt("return");case 21:s=1e3*c.exp,Date.now()>=s?chrome.identity.getAuthToken({interactive:!0},(function(r){chrome.runtime.lastError?e(new Error(chrome.runtime.lastError)):t(r)})):t(o);case 24:case"end":return r.stop()}}),r,null,[[13,17]])})));return function(t){return r.apply(this,arguments)}}())})));case 1:case"end":return t.stop()}}),t)}))),a.apply(this,arguments)},o=function(){return a.apply(this,arguments)},t.abrupt("return",new Promise(function(){var t=l(u().mark((function t(a,i){var c,s,l,f,h,p,d,v;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,o();case 3:if((c=t.sent)&&null!==c){t.next=6;break}throw new Error("Sign-in failed");case 6:return s=new Headers({Authorization:"Bearer ".concat(c),"Content-Type":e.type}),t.next=9,fetch("https://www.googleapis.com/upload/drive/v3/files?uploadType=media",{method:"POST",headers:s,body:e});case 9:if((l=t.sent).ok){t.next=12;break}throw new Error("Error uploading to Google Drive: ".concat(l.status));case 12:return t.next=14,l.json();case 14:if(f=t.sent,h=f.id){t.next=18;break}throw new Error("File ID is undefined");case 18:return p={name:r},t.next=21,fetch("https://www.googleapis.com/drive/v3/files/".concat(h),{method:"PATCH",headers:new Headers({Authorization:"Bearer ".concat(c),"Content-Type":"application/json; charset=UTF-8"}),body:JSON.stringify(p)});case 21:if((d=t.sent).ok){t.next=28;break}return t.next=25,d.json();case 25:throw v=t.sent,console.error("Error updating file metadata:",d.status,v.error.message),new Error("Error updating file metadata: ".concat(d.status));case 28:n({status:"ok",url:h}),chrome.tabs.create({url:"https://drive.google.com/file/d/".concat(h,"/view")}),a("https://drive.google.com/file/d/".concat(h,"/view")),t.next=38;break;case 33:t.prev=33,t.t0=t.catch(0),console.error("Error uploading to Google Drive:",t.t0.message),n({status:"ew",url:null}),i(t.t0);case 38:case"end":return t.stop()}}),t,null,[[0,33]])})));return function(e,r){return t.apply(this,arguments)}}()));case 3:case"end":return t.stop()}}),t)})));return function(e,r,n){return t.apply(this,arguments)}}();function h(t){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},h(t)}function p(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,a,i,c=[],u=!0,s=!1;try{if(a=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=a.call(r)).done)&&(c.push(n.value),c.length!==e);u=!0);}catch(t){s=!0,o=t}finally{try{if(!u&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return c}}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return d(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return d(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function v(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function m(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?v(Object(r),!0).forEach((function(e){y(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):v(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function y(t,e,r){var n;return n=function(t,e){if("object"!=h(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=h(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"),(e="symbol"==h(n)?n:n+"")in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function g(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */g=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var a=e&&e.prototype instanceof b?e:b,i=Object.create(a.prototype),c=new I(n||[]);return o(i,"_invoke",{value:T(t,r,c)}),i}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",d="suspendedYield",v="executing",m="completed",y={};function b(){}function w(){}function x(){}var k={};s(k,i,(function(){return this}));var E=Object.getPrototypeOf,L=E&&E(E(N([])));L&&L!==r&&n.call(L,i)&&(k=L);var _=x.prototype=b.prototype=Object.create(k);function O(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function j(t,e){function r(o,a,i,c){var u=f(t[o],t,a);if("throw"!==u.type){var s=u.arg,l=s.value;return l&&"object"==h(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,i,c)}),(function(t){r("throw",t,i,c)})):e.resolve(l).then((function(t){s.value=t,i(s)}),(function(t){return r("throw",t,i,c)}))}c(u.arg)}var a;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function T(e,r,n){var o=p;return function(a,i){if(o===v)throw Error("Generator is already running");if(o===m){if("throw"===a)throw i;return{value:t,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var u=S(c,n);if(u){if(u===y)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?m:d,s.arg===y)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=m,n.method="throw",n.arg=s.arg)}}}function S(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,S(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var a=f(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,y;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function A(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function N(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(h(e)+" is not iterable")}return w.prototype=x,o(_,"constructor",{value:x,configurable:!0}),o(x,"constructor",{value:w,configurable:!0}),w.displayName=s(x,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,s(t,u,"GeneratorFunction")),t.prototype=Object.create(_),t},e.awrap=function(t){return{__await:t}},O(j.prototype),s(j.prototype,c,(function(){return this})),e.AsyncIterator=j,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new j(l(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},O(_),s(_,u,"Generator"),s(_,i,(function(){return this})),s(_,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=N,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(A),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var u=n.call(i,"catchLoc"),s=n.call(i,"finallyLoc");if(u&&s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,y):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),A(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;A(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:N(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function b(t,e,r,n,o,a,i){try{var c=t[a](i),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function w(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){b(a,n,o,i,c,"next",t)}function c(t){b(a,n,o,i,c,"throw",t)}i(void 0)}))}}var x=function(){var t=w(g().mark((function t(e,r){var n,o,a,i=arguments;return g().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=i.length>2&&void 0!==i[2]?i[2]:null,o=i.length>3&&void 0!==i[3]?i[3]:null,null!==e&&null!==r){t.next=4;break}return t.abrupt("return",Promise.reject(new Error("Tab ID or message is null")));case 4:return t.prev=4,t.next=7,new Promise((function(t,r){chrome.tabs.get(e,(function(e){chrome.runtime.lastError?r(chrome.runtime.lastError.message):t(e)}))}));case 7:if((a=t.sent)&&a.url&&!a.url.startsWith("chrome://")&&!a.url.startsWith("chromewebstore.google.com")&&!a.url.startsWith("chrome.google.com/webstore")&&""!==a.url&&"about:blank"!==a.url){t.next=10;break}return t.abrupt("return",Promise.reject(new Error("Invalid tab URL")));case 10:return t.abrupt("return",new Promise((function(t,e){chrome.tabs.sendMessage(a.id,r,(function(r){chrome.runtime.lastError?e(chrome.runtime.lastError.message):n?n(r):t(r)}))})));case 13:return t.prev=13,t.t0=t.catch(4),console.error("Error sending message to tab:",t.t0),o&&"function"==typeof o&&o(),t.abrupt("return",Promise.reject(t.t0));case 18:case"end":return t.stop()}}),t,null,[[4,13]])})));return function(e,r){return t.apply(this,arguments)}}(),k=function(){var t=w(g().mark((function t(e){var r;return g().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!==e){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,t.next=5,new Promise((function(t){chrome.tabs.get(e,(function(e){t(e)}))}));case 5:(r=t.sent)&&r.id&&chrome.windows.update(r.windowId,{focused:!0}).then((function(){chrome.tabs.update(r.id,{active:!0})})),t.next=11;break;case 9:t.prev=9,t.t0=t.catch(2);case 11:case"end":return t.stop()}}),t,null,[[2,9]])})));return function(e){return t.apply(this,arguments)}}(),E=function(){var t=w(g().mark((function t(e){var r;return g().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!==e){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,t.next=5,new Promise((function(t){chrome.tabs.get(e,(function(e){t(e)}))}));case 5:(r=t.sent)&&r.id&&chrome.tabs.remove(r.id),t.next=11;break;case 9:t.prev=9,t.t0=t.catch(2);case 11:case"end":return t.stop()}}),t,null,[[2,9]])})));return function(e){return t.apply(this,arguments)}}(),L=function(){var t=w(g().mark((function t(){var e,r,n,o,a=arguments;return g().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=m({active:!0,lastFocusedWindow:!0},a.length>0&&void 0!==a[0]?a[0]:{}),t.next=4,chrome.tabs.query(e);case 4:return r=t.sent,n=p(r,1),o=n[0],t.abrupt("return",o);case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),_=function(){var t=w(g().mark((function t(e){var r,n,o,a,i=arguments;return g().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=i.length>1&&void 0!==i[1]&&i[1],n=i.length>2&&void 0!==i[2]&&i[2],e){t.next=4;break}return t.abrupt("return");case 4:r&&((a=chrome.i18n.getMessage("@@ui_locale")).includes("en")||(o="http://translate.google.com/translate?js=n&sl=auto&tl="+a+"&u="+e)),o&&chrome.tabs.create({url:o,active:n});case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),O=r(3790),j=r.n(O),T=(r(4692),r(4353)),S=r.n(T);function P(t){return S()("2024-04-01 ".concat(t),"YYYY-MM-DD HH:mm:ss.SSS")}function A(t){return new Promise((function(e){setTimeout(e,t)}))}function I(t){return I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},I(t)}function N(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */N=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var a=e&&e.prototype instanceof y?e:y,i=Object.create(a.prototype),c=new P(n||[]);return o(i,"_invoke",{value:O(t,r,c)}),i}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",v="completed",m={};function y(){}function g(){}function b(){}var w={};s(w,i,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(A([])));k&&k!==r&&n.call(k,i)&&(w=k);var E=b.prototype=y.prototype=Object.create(w);function L(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function _(t,e){function r(o,a,i,c){var u=f(t[o],t,a);if("throw"!==u.type){var s=u.arg,l=s.value;return l&&"object"==I(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,i,c)}),(function(t){r("throw",t,i,c)})):e.resolve(l).then((function(t){s.value=t,i(s)}),(function(t){return r("throw",t,i,c)}))}c(u.arg)}var a;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function O(e,r,n){var o=h;return function(a,i){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===a)throw i;return{value:t,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var u=j(c,n);if(u){if(u===m)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?v:p,s.arg===m)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function j(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,j(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var a=f(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,m;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,m):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function A(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(I(e)+" is not iterable")}return g.prototype=b,o(E,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=s(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,s(t,u,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},L(_.prototype),s(_.prototype,c,(function(){return this})),e.AsyncIterator=_,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new _(l(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},L(E),s(E,u,"Generator"),s(E,i,(function(){return this})),s(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=A,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(S),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var u=n.call(i,"catchLoc"),s=n.call(i,"finallyLoc");if(u&&s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,m):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),S(r),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;S(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:A(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),m}},e}function D(t,e,r,n,o,a,i){try{var c=t[a](i),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function R(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){D(a,n,o,i,c,"next",t)}function c(t){D(a,n,o,i,c,"throw",t)}i(void 0)}))}}function G(t){var e,r,n,o=2;for("undefined"!=typeof Symbol&&(r=Symbol.asyncIterator,n=Symbol.iterator);o--;){if(r&&null!=(e=t[r]))return e.call(t);if(n&&null!=(e=t[n]))return new F(e.call(t));r="@@asyncIterator",n="@@iterator"}throw new TypeError("Object is not async iterable")}function F(t){function e(t){if(Object(t)!==t)return Promise.reject(new TypeError(t+" is not an object."));var e=t.done;return Promise.resolve(t.value).then((function(t){return{value:t,done:e}}))}return F=function(t){this.s=t,this.n=t.next},F.prototype={s:null,n:null,next:function(){return e(this.n.apply(this.s,arguments))},return:function(t){var r=this.s.return;return void 0===r?Promise.resolve({value:t,done:!0}):e(r.apply(this.s,arguments))},throw:function(t){var r=this.s.return;return void 0===r?Promise.reject(t):e(r.apply(this.s,arguments))}},new F(t)}function U(){return C.apply(this,arguments)}function C(){return C=R(N().mark((function t(){var e,r,n=arguments;return N().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=n.length>0&&void 0!==n[0]?n[0]:chrome.windows.WindowState.NORMAL,t.next=3,chrome.windows.create({});case 3:return r=t.sent,chrome.windows.update(r.id,{state:null!=e?e:chrome.windows.WindowState.FULLSCREEN}),t.abrupt("return",r);case 6:case"end":return t.stop()}}),t)}))),C.apply(this,arguments)}function M(t){return q.apply(this,arguments)}function q(){return(q=R(N().mark((function t(e){var r,n,o,a,i,c,u,s;return N().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,chrome.tabs.query({windowId:e});case 2:r=t.sent,n=r.filter((function(t){var e=t.url,r=t.pendingUrl;return["","chrome://newtab/","chrome://newtab"].includes(e||r)})),o=!1,a=!1,t.prev=6,c=G(n);case 8:return t.next=10,c.next();case 10:if(!(o=!(u=t.sent).done)){t.next=17;break}return s=u.value,t.next=14,chrome.tabs.remove(s.id);case 14:o=!1,t.next=8;break;case 17:t.next=23;break;case 19:t.prev=19,t.t0=t.catch(6),a=!0,i=t.t0;case 23:if(t.prev=23,t.prev=24,!o||null==c.return){t.next=28;break}return t.next=28,c.return();case 28:if(t.prev=28,!a){t.next=31;break}throw i;case 31:return t.finish(28);case 32:return t.finish(23);case 33:case"end":return t.stop()}}),t,null,[[6,19,23,33],[24,,28,32]])})))).apply(this,arguments)}const B="object"==typeof global&&global&&global.Object===Object&&global;var Y="object"==typeof self&&self&&self.Object===Object&&self;const V=B||Y||Function("return this")();const z=V.Symbol;var W=Object.prototype,H=W.hasOwnProperty,J=W.toString,X=z?z.toStringTag:void 0;const $=function(t){var e=H.call(t,X),r=t[X];try{t[X]=void 0;var n=!0}catch(t){}var o=J.call(t);return n&&(e?t[X]=r:delete t[X]),o};var K=Object.prototype.toString;const Z=function(t){return K.call(t)};var Q=z?z.toStringTag:void 0;const tt=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":Q&&Q in Object(t)?$(t):Z(t)};const et=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)};const rt=function(t){if(!et(t))return!1;var e=tt(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e};const nt=V["__core-js_shared__"];var ot,at=(ot=/[^.]+$/.exec(nt&&nt.keys&&nt.keys.IE_PROTO||""))?"Symbol(src)_1."+ot:"";const it=function(t){return!!at&&at in t};var ct=Function.prototype.toString;const ut=function(t){if(null!=t){try{return ct.call(t)}catch(t){}try{return t+""}catch(t){}}return""};var st=/^\[object .+?Constructor\]$/,lt=Function.prototype,ft=Object.prototype,ht=lt.toString,pt=ft.hasOwnProperty,dt=RegExp("^"+ht.call(pt).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");const vt=function(t){return!(!et(t)||it(t))&&(rt(t)?dt:st).test(ut(t))};const mt=function(t,e){return null==t?void 0:t[e]};const yt=function(t,e){var r=mt(t,e);return vt(r)?r:void 0};const gt=yt(Object,"create");const bt=function(){this.__data__=gt?gt(null):{},this.size=0};const wt=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e};var xt=Object.prototype.hasOwnProperty;const kt=function(t){var e=this.__data__;if(gt){var r=e[t];return"__lodash_hash_undefined__"===r?void 0:r}return xt.call(e,t)?e[t]:void 0};var Et=Object.prototype.hasOwnProperty;const Lt=function(t){var e=this.__data__;return gt?void 0!==e[t]:Et.call(e,t)};const _t=function(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=gt&&void 0===e?"__lodash_hash_undefined__":e,this};function Ot(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Ot.prototype.clear=bt,Ot.prototype.delete=wt,Ot.prototype.get=kt,Ot.prototype.has=Lt,Ot.prototype.set=_t;const jt=Ot;const Tt=function(){this.__data__=[],this.size=0};const St=function(t,e){return t===e||t!=t&&e!=e};const Pt=function(t,e){for(var r=t.length;r--;)if(St(t[r][0],e))return r;return-1};var At=Array.prototype.splice;const It=function(t){var e=this.__data__,r=Pt(e,t);return!(r<0)&&(r==e.length-1?e.pop():At.call(e,r,1),--this.size,!0)};const Nt=function(t){var e=this.__data__,r=Pt(e,t);return r<0?void 0:e[r][1]};const Dt=function(t){return Pt(this.__data__,t)>-1};const Rt=function(t,e){var r=this.__data__,n=Pt(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this};function Gt(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Gt.prototype.clear=Tt,Gt.prototype.delete=It,Gt.prototype.get=Nt,Gt.prototype.has=Dt,Gt.prototype.set=Rt;const Ft=Gt;const Ut=yt(V,"Map");const Ct=function(){this.size=0,this.__data__={hash:new jt,map:new(Ut||Ft),string:new jt}};const Mt=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t};const qt=function(t,e){var r=t.__data__;return Mt(e)?r["string"==typeof e?"string":"hash"]:r.map};const Bt=function(t){var e=qt(this,t).delete(t);return this.size-=e?1:0,e};const Yt=function(t){return qt(this,t).get(t)};const Vt=function(t){return qt(this,t).has(t)};const zt=function(t,e){var r=qt(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this};function Wt(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Wt.prototype.clear=Ct,Wt.prototype.delete=Bt,Wt.prototype.get=Yt,Wt.prototype.has=Vt,Wt.prototype.set=zt;const Ht=Wt;const Jt=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this};const Xt=function(t){return this.__data__.has(t)};function $t(t){var e=-1,r=null==t?0:t.length;for(this.__data__=new Ht;++e<r;)this.add(t[e])}$t.prototype.add=$t.prototype.push=Jt,$t.prototype.has=Xt;const Kt=$t;const Zt=function(t,e,r,n){for(var o=t.length,a=r+(n?1:-1);n?a--:++a<o;)if(e(t[a],a,t))return a;return-1};const Qt=function(t){return t!=t};const te=function(t,e,r){for(var n=r-1,o=t.length;++n<o;)if(t[n]===e)return n;return-1};const ee=function(t,e,r){return e==e?te(t,e,r):Zt(t,Qt,r)};const re=function(t,e){return!!(null==t?0:t.length)&&ee(t,e,0)>-1};const ne=function(t,e,r){for(var n=-1,o=null==t?0:t.length;++n<o;)if(r(e,t[n]))return!0;return!1};const oe=function(t,e){return t.has(e)};const ae=yt(V,"Set");const ie=function(){};const ce=function(t){var e=-1,r=Array(t.size);return t.forEach((function(t){r[++e]=t})),r};const ue=ae&&1/ce(new ae([,-0]))[1]==1/0?function(t){return new ae(t)}:ie;const se=function(t,e,r){var n=-1,o=re,a=t.length,i=!0,c=[],u=c;if(r)i=!1,o=ne;else if(a>=200){var s=e?null:ue(t);if(s)return ce(s);i=!1,o=oe,u=new Kt}else u=e?[]:c;t:for(;++n<a;){var l=t[n],f=e?e(l):l;if(l=r||0!==l?l:0,i&&f==f){for(var h=u.length;h--;)if(u[h]===f)continue t;e&&u.push(f),c.push(l)}else o(u,f,r)||(u!==c&&u.push(f),c.push(l))}return c};const le=function(t){return t&&t.length?se(t):[]};function fe(t){return fe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fe(t)}function he(t,e,r){var n;return n=function(t,e){if("object"!=fe(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=fe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"),(e="symbol"==fe(n)?n:n+"")in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var pe="stories",de="productions",ve="video_templates",me="video_clips",ye="voice_clips",ge="assets",be="voice_names",we="font_names",xe=(he(he(he(he(he(he(he(he(he({},"pages","/pages"),pe,"/stories"),de,"/productions"),ve,"/video_templates"),me,"/video_clips"),ye,"/voice_clips"),ge,"/assets"),be,"/voice_names"),we,"/font_names"),he(he(he(he(he({},de,"production"),ve,"video_template"),me,"video_clip"),ye,"voice_clip"),ge,"asset"),{PRIMARY_COLOR:"#45b7f7",RESOURCE_BASE:"https://knitter.ai/videomaker",NOT_ADDED_REEVAL_COLOR:"#1677ff",ADDED_REEVAL_COLOR:"#f66b11"}),ke="reeval.menu.add",Ee={PAGES:"reeval.storage.pages",PAGE_ACTION_BAR:"reeval.storage.page.action.bar",APP_TAB_ID:"reeval.storage.app.tab.id"},Le={UPDATE_ACTION_COUNT:"reeval.msg.update.action.count",ADD_TO_REEVAL:"reeval.msg.add.to.reeval",ADDED_TO_REEVAL:"reeval.msg.added.to.reeval",IS_ADDED_REEVAL:"reeval.msg.is.added",APP_RELOAD:"reeval.msg.app.reload"};function _e(t){var e=new URL(null!=t?t:window.location.href);return e.searchParams.delete("reeval"),e.toString()}function Oe(t){return Oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Oe(t)}function je(t,e,r){var n;return n=function(t,e){if("object"!=Oe(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Oe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"),(e="symbol"==Oe(n)?n:n+"")in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Te(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */Te=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var a=e&&e.prototype instanceof y?e:y,i=Object.create(a.prototype),c=new P(n||[]);return o(i,"_invoke",{value:O(t,r,c)}),i}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",v="completed",m={};function y(){}function g(){}function b(){}var w={};s(w,i,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(A([])));k&&k!==r&&n.call(k,i)&&(w=k);var E=b.prototype=y.prototype=Object.create(w);function L(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function _(t,e){function r(o,a,i,c){var u=f(t[o],t,a);if("throw"!==u.type){var s=u.arg,l=s.value;return l&&"object"==Oe(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,i,c)}),(function(t){r("throw",t,i,c)})):e.resolve(l).then((function(t){s.value=t,i(s)}),(function(t){return r("throw",t,i,c)}))}c(u.arg)}var a;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function O(e,r,n){var o=h;return function(a,i){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===a)throw i;return{value:t,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var u=j(c,n);if(u){if(u===m)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?v:p,s.arg===m)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function j(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,j(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var a=f(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,m;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,m):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function A(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Oe(e)+" is not iterable")}return g.prototype=b,o(E,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=s(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,s(t,u,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},L(_.prototype),s(_.prototype,c,(function(){return this})),e.AsyncIterator=_,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new _(l(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},L(E),s(E,u,"Generator"),s(E,i,(function(){return this})),s(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=A,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(S),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var u=n.call(i,"catchLoc"),s=n.call(i,"finallyLoc");if(u&&s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,m):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),S(r),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;S(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:A(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),m}},e}function Se(t,e,r,n,o,a,i){try{var c=t[a](i),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function Pe(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){Se(a,n,o,i,c,"next",t)}function c(t){Se(a,n,o,i,c,"throw",t)}i(void 0)}))}}var Ae,Ie,Ne,De={get:(Ne=Pe(Te().mark((function t(e){var r,n;return Te().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,chrome.storage.local.get(e);case 2:return r=t.sent,n=r[e],t.abrupt("return",n);case 5:case"end":return t.stop()}}),t)}))),function(t){return Ne.apply(this,arguments)}),set:(Ie=Pe(Te().mark((function t(e,r){return Te().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,chrome.storage.local.set(je({},e,r));case 2:case"end":return t.stop()}}),t)}))),function(t,e){return Ie.apply(this,arguments)}),remove:(Ae=Pe(Te().mark((function t(e){return Te().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,chrome.storage.local.remove(e);case 2:case"end":return t.stop()}}),t)}))),function(t){return Ae.apply(this,arguments)})},Re=function(t,e){var r=function(r,n,o){r.type===t&&(null==e||e(r.options,n,o))};return chrome.runtime.onMessage.addListener(r),function(){chrome.runtime.onMessage.removeListener(r)}};function Ge(t){return Ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ge(t)}function Fe(t){return function(t){if(Array.isArray(t))return Be(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||qe(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ue(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */Ue=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var a=e&&e.prototype instanceof y?e:y,i=Object.create(a.prototype),c=new P(n||[]);return o(i,"_invoke",{value:O(t,r,c)}),i}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",v="completed",m={};function y(){}function g(){}function b(){}var w={};s(w,i,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(A([])));k&&k!==r&&n.call(k,i)&&(w=k);var E=b.prototype=y.prototype=Object.create(w);function L(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function _(t,e){function r(o,a,i,c){var u=f(t[o],t,a);if("throw"!==u.type){var s=u.arg,l=s.value;return l&&"object"==Ge(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,i,c)}),(function(t){r("throw",t,i,c)})):e.resolve(l).then((function(t){s.value=t,i(s)}),(function(t){return r("throw",t,i,c)}))}c(u.arg)}var a;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function O(e,r,n){var o=h;return function(a,i){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===a)throw i;return{value:t,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var u=j(c,n);if(u){if(u===m)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?v:p,s.arg===m)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function j(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,j(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var a=f(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,m;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,m):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function A(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Ge(e)+" is not iterable")}return g.prototype=b,o(E,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=s(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,s(t,u,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},L(_.prototype),s(_.prototype,c,(function(){return this})),e.AsyncIterator=_,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new _(l(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},L(E),s(E,u,"Generator"),s(E,i,(function(){return this})),s(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=A,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(S),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var u=n.call(i,"catchLoc"),s=n.call(i,"finallyLoc");if(u&&s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,m):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),S(r),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;S(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:A(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),m}},e}function Ce(t,e,r){var n;return n=function(t,e){if("object"!=Ge(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Ge(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"),(e="symbol"==Ge(n)?n:n+"")in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Me(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,a,i,c=[],u=!0,s=!1;try{if(a=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=a.call(r)).done)&&(c.push(n.value),c.length!==e);u=!0);}catch(t){s=!0,o=t}finally{try{if(!u&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return c}}(t,e)||qe(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function qe(t,e){if(t){if("string"==typeof t)return Be(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Be(t,e):void 0}}function Be(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Ye(t,e,r,n,o,a,i){try{var c=t[a](i),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function Ve(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){Ye(a,n,o,i,c,"next",t)}function c(t){Ye(a,n,o,i,c,"throw",t)}i(void 0)}))}}chrome.action.onClicked.addListener(function(){var t=Ve(Ue().mark((function t(e){var r,n,o,a,i,c,u,s,l;return Ue().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.id,r=e.windowId,n=chrome.runtime.getURL("reevalapp.html"),o=chrome.tabs,a=o.create,i=o.update,c=o.move,t.next=5,chrome.tabs.query({url:n});case 5:if(u=t.sent,s=Me(u,1),l=s[0]){t.next=12;break}return t.next=11,a({url:n,windowId:r,index:0,active:!0});case 11:l=t.sent;case 12:if(!l){t.next=19;break}if(t.t0=l.windowId!==r,!t.t0){t.next=17;break}return t.next=17,c(l.id,{windowId:r,index:0});case 17:return t.next=19,i(l.id,{highlighted:!0,active:!0});case 19:return t.next=21,chrome.storage.local.set(Ce({},Ee.APP_TAB_ID,l.id));case 21:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),chrome.runtime.onMessage.addListener(function(){var t=Ve(Ue().mark((function t(e){var r,n;return Ue().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.type,n=e.options,r!==Le.UPDATE_ACTION_COUNT){t.next=6;break}return t.next=4,chrome.action.setBadgeText({text:String(null==n?void 0:n.length)});case 4:return t.next=6,chrome.storage.local.set(Ce({},Ee.PAGES,n));case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),chrome.tabs.onRemoved.addListener(function(){var t=Ve(Ue().mark((function t(e){var r,n,o;return Ue().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=Ee.APP_TAB_ID,t.next=3,chrome.storage.local.get(r);case 3:if(n=t.sent,o=n[r],t.t0=e===o,!t.t0){t.next=9;break}return t.next=9,chrome.storage.local.remove(r);case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());var ze,We,He,Je,Xe=function(){var t=Ve(Ue().mark((function t(e){var r,n,o;return Ue().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,chrome.storage.local.get(Ee.PAGES);case 2:return r=t.sent,n=r[Ee.PAGES],o=le([].concat(Fe(null!=n?n:[]),[_e(e)])),t.next=7,chrome.storage.local.set(Ce({},Ee.PAGES,o));case 7:return t.next=9,chrome.action.setBadgeText({text:String(o.length)});case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),$e=function(){var t=Ve(Ue().mark((function t(e){var r,n,o,a;return Ue().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=e,!t.t0){t.next=4;break}return t.next=4,Xe(e);case 4:return t.next=6,fetch("".concat(xe.RESOURCE_BASE,"/pages"));case 6:return r=t.sent,t.next=9,r.json();case 9:if(n=t.sent,o=n.data,!(a=null==o?void 0:o.length)){t.next=19;break}return t.next=15,chrome.action.setBadgeText({text:String(a)});case 15:return t.next=17,chrome.action.setBadgeBackgroundColor({color:xe.NOT_ADDED_REEVAL_COLOR});case 17:return t.next=19,chrome.storage.local.set(Ce({},Ee.PAGES,o.map((function(t){return _e(t.url)}))));case 19:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();function Ke(t){return Ke="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ke(t)}function Ze(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */Ze=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var a=e&&e.prototype instanceof y?e:y,i=Object.create(a.prototype),c=new P(n||[]);return o(i,"_invoke",{value:O(t,r,c)}),i}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",v="completed",m={};function y(){}function g(){}function b(){}var w={};s(w,i,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(A([])));k&&k!==r&&n.call(k,i)&&(w=k);var E=b.prototype=y.prototype=Object.create(w);function L(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function _(t,e){function r(o,a,i,c){var u=f(t[o],t,a);if("throw"!==u.type){var s=u.arg,l=s.value;return l&&"object"==Ke(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,i,c)}),(function(t){r("throw",t,i,c)})):e.resolve(l).then((function(t){s.value=t,i(s)}),(function(t){return r("throw",t,i,c)}))}c(u.arg)}var a;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function O(e,r,n){var o=h;return function(a,i){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===a)throw i;return{value:t,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var u=j(c,n);if(u){if(u===m)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?v:p,s.arg===m)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function j(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,j(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var a=f(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,m;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,m):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function A(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Ke(e)+" is not iterable")}return g.prototype=b,o(E,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=s(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,s(t,u,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},L(_.prototype),s(_.prototype,c,(function(){return this})),e.AsyncIterator=_,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new _(l(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},L(E),s(E,u,"Generator"),s(E,i,(function(){return this})),s(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=A,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(S),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var u=n.call(i,"catchLoc"),s=n.call(i,"finallyLoc");if(u&&s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,m):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),S(r),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;S(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:A(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),m}},e}function Qe(t,e,r,n,o,a,i){try{var c=t[a](i),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function tr(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){Qe(a,n,o,i,c,"next",t)}function c(t){Qe(a,n,o,i,c,"throw",t)}i(void 0)}))}}function er(t){return rr.apply(this,arguments)}function rr(){return(rr=tr(Ze().mark((function t(e){var r,n,o,a;return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.url,t.next=3,chrome.storage.local.get(Ee.PAGES);case 3:if(n=t.sent,n[Ee.PAGES].includes(r)){t.next=24;break}return t.next=8,chrome.tabs.sendMessage(e.id,{type:Le.ADD_TO_REEVAL});case 8:return t.next=10,fetch(r).then((function(t){return t.text()}));case 10:return o=t.sent,t.next=13,fetch("".concat(xe.RESOURCE_BASE,"/pages"),{method:"post",body:JSON.stringify({url:r,title:e.title,html_content:o})});case 13:return t.next=15,chrome.tabs.sendMessage(e.id,{type:Le.ADDED_TO_REEVAL});case 15:return t.next=17,De.get(Ee.APP_TAB_ID);case 17:if(a=t.sent,t.t0=a,!t.t0){t.next=22;break}return t.next=22,chrome.tabs.sendMessage(a,{type:Le.APP_RELOAD,options:Math.random()});case 22:return t.next=24,$e(r);case 24:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function nr(t){return nr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nr(t)}function or(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function ar(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?or(Object(r),!0).forEach((function(e){ir(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):or(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function ir(t,e,r){var n;return n=function(t,e){if("object"!=nr(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=nr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"),(e="symbol"==nr(n)?n:n+"")in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function cr(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=sr(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return i=t.done,t},e:function(t){c=!0,a=t},f:function(){try{i||null==r.return||r.return()}finally{if(c)throw a}}}}function ur(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,a,i,c=[],u=!0,s=!1;try{if(a=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=a.call(r)).done)&&(c.push(n.value),c.length!==e);u=!0);}catch(t){s=!0,o=t}finally{try{if(!u&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return c}}(t,e)||sr(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function sr(t,e){if(t){if("string"==typeof t)return lr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?lr(t,e):void 0}}function lr(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function fr(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */fr=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var a=e&&e.prototype instanceof y?e:y,i=Object.create(a.prototype),c=new P(n||[]);return o(i,"_invoke",{value:O(t,r,c)}),i}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",v="completed",m={};function y(){}function g(){}function b(){}var w={};s(w,i,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(A([])));k&&k!==r&&n.call(k,i)&&(w=k);var E=b.prototype=y.prototype=Object.create(w);function L(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function _(t,e){function r(o,a,i,c){var u=f(t[o],t,a);if("throw"!==u.type){var s=u.arg,l=s.value;return l&&"object"==nr(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,i,c)}),(function(t){r("throw",t,i,c)})):e.resolve(l).then((function(t){s.value=t,i(s)}),(function(t){return r("throw",t,i,c)}))}c(u.arg)}var a;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function O(e,r,n){var o=h;return function(a,i){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===a)throw i;return{value:t,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var u=j(c,n);if(u){if(u===m)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?v:p,s.arg===m)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function j(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,j(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var a=f(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,m;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,m):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function A(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(nr(e)+" is not iterable")}return g.prototype=b,o(E,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=s(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,s(t,u,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},L(_.prototype),s(_.prototype,c,(function(){return this})),e.AsyncIterator=_,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new _(l(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},L(E),s(E,u,"Generator"),s(E,i,(function(){return this})),s(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=A,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(S),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var u=n.call(i,"catchLoc"),s=n.call(i,"finallyLoc");if(u&&s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,m):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),S(r),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;S(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:A(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),m}},e}function hr(t,e,r,n,o,a,i){try{var c=t[a](i),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function pr(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){hr(a,n,o,i,c,"next",t)}function c(t){hr(a,n,o,i,c,"throw",t)}i(void 0)}))}}function dr(t){var e,r,n,o=2;for("undefined"!=typeof Symbol&&(r=Symbol.asyncIterator,n=Symbol.iterator);o--;){if(r&&null!=(e=t[r]))return e.call(t);if(n&&null!=(e=t[n]))return new vr(e.call(t));r="@@asyncIterator",n="@@iterator"}throw new TypeError("Object is not async iterable")}function vr(t){function e(t){if(Object(t)!==t)return Promise.reject(new TypeError(t+" is not an object."));var e=t.done;return Promise.resolve(t.value).then((function(t){return{value:t,done:e}}))}return vr=function(t){this.s=t,this.n=t.next},vr.prototype={s:null,n:null,next:function(){return e(this.n.apply(this.s,arguments))},return:function(t){var r=this.s.return;return void 0===r?Promise.resolve({value:t,done:!0}):e(r.apply(this.s,arguments))},throw:function(t){var r=this.s.return;return void 0===r?Promise.reject(t):e(r.apply(this.s,arguments))}},new vr(t)}(ze=$e,We=300,function(){var t=this,e=arguments,r=He&&!Je;clearTimeout(Je),Je=setTimeout((function(){Je=null,He||ze.apply(t,e)}),We),r&&ze.apply(t,e)})(),chrome.contextMenus.create({id:ke,title:"Add to ReEval",contexts:["all"],documentUrlPatterns:["http://*/*","https://*/*"]}),Re(Le.IS_ADDED_REEVAL,function(){var t=tr(Ze().mark((function t(e){var r;return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=e.added,e.url,chrome.contextMenus.update(ke,{title:r?"Added ReEval":"Add to ReEval",enabled:!r});case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),chrome.tabs.onActivated.addListener(function(){var t=tr(Ze().mark((function t(e){var r,n,o,a,i,c;return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.tabId,t.next=3,chrome.tabs.get(n);case 3:if(o=t.sent,console.log("context-menu tabs.onActivated",o),o.url){t.next=7;break}return t.abrupt("return");case 7:return a=_e(o.url),t.next=10,De.get(Ee.PAGES);case 10:if(i=t.sent,c=null==i||null===(r=i.includes)||void 0===r?void 0:r.call(i,a),chrome.contextMenus.update(ke,{title:c?"Added ReEval":"Add to ReEval",enabled:!c}),!c){t.next=22;break}return t.next=16,chrome.action.setBadgeBackgroundColor({color:xe.ADDED_REEVAL_COLOR});case 16:return t.next=18,chrome.action.setBadgeTextColor({color:"#fff"});case 18:return t.next=20,chrome.action.setIcon({path:"assets/recording-reeval.png"});case 20:t.next=26;break;case 22:return t.next=24,chrome.action.setBadgeBackgroundColor({color:xe.NOT_ADDED_REEVAL_COLOR});case 24:return t.next=26,chrome.action.setIcon({path:"assets/icon-34.png"});case 26:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),chrome.contextMenus.onClicked.addListener(function(){var t=tr(Ze().mark((function t(e,r){return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.menuItemId!==ke){t.next=4;break}return t.next=4,er(r);case 4:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}()),chrome.runtime.onMessage.addListener(function(){var t=tr(Ze().mark((function t(e,r,n){var o;return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=r.tab,e.type!==Ee.ADD_TO_REEVAL){t.next=4;break}return t.next=4,er(o);case 4:case"end":return t.stop()}}),t)})));return function(e,r,n){return t.apply(this,arguments)}}()),j().config({driver:j().INDEXEDDB,name:"screenity",version:1});var mr=j().createInstance({name:"chunks"}),yr=j().createInstance({name:"localDirectory"}),gr=function(){var t=pr(fr().mark((function t(){var e,r,n,o;return fr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,chrome.storage.local.get(["recordingTab"]);case 2:return e=t.sent,r=e.recordingTab,t.next=6,chrome.storage.local.get(["offscreen"]);case 6:n=t.sent,o=n.offscreen,(null!==r||o)&&(chrome.storage.local.set({recording:!0}),xr());case 9:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),br=function(){var t=pr(fr().mark((function t(){var e,r;return fr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"editor.html",navigator.userAgent.includes("Chrome/")&&parseInt(navigator.userAgent.match(/Chrome\/([0-9]+)/)[1],10)<=109&&"editorfallback.html",t.next=4,chrome.storage.local.get(["activeTab"]);case 4:e=t.sent,r=e.activeTab,chrome.tabs.get(r,(function(t){t&&chrome.windows.update(t.windowId,{focused:!0},pr(fr().mark((function t(){var e;return fr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return chrome.tabs.update(r,{active:!0,selected:!0,highlighted:!0}),k(r),x(r,{type:"ready-to-record"}),t.next=5,chrome.storage.local.get(["countdown"]);case 5:e=t.sent,e.countdown?setTimeout((function(){gr()}),3500):setTimeout((function(){gr()}),500);case 8:case"end":return t.stop()}}),t)}))))}));case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),wr=function(){var t=pr(fr().mark((function t(){var e,r;return fr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,chrome.storage.local.get(["activeTab"]);case 2:e=t.sent,r=e.activeTab,k(r).then(pr(fr().mark((function t(){var e;return fr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return x(r,{type:"ready-to-record"}),t.next=3,chrome.storage.local.get(["countdown"]);case 3:e=t.sent,e.countdown?setTimeout((function(){gr()}),3e3):xr();case 6:case"end":return t.stop()}}),t)}))));case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),xr=function(){var t=pr(fr().mark((function t(){var e,r,n,o,a,i,c;return fr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return chrome.storage.local.set({recordingStartTime:Date.now(),restarting:!1,recording:!0}),t.next=3,chrome.storage.local.get(["customRegion"]);case 3:return e=t.sent,r=e.customRegion,Rr(r?{type:"start-recording-tab",region:!0}:{type:"start-recording-tab"}),chrome.action.setIcon({path:"assets/recording-logo.png"}),t.next=9,chrome.storage.local.get(["alarm"]);case 9:return n=t.sent,o=n.alarm,t.next=13,chrome.storage.local.get(["alarmTime"]);case 13:a=t.sent,i=a.alarmTime,o&&(c=parseFloat(i),chrome.alarms.create("recording-alarm",{delayInMinutes:c/60}));case 16:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();chrome.commands.onCommand.addListener(function(){var t=pr(fr().mark((function t(e){var r,n,o;return fr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("start-recording"!==e){t.next=7;break}return t.next=3,L();case 3:r=t.sent,!1===navigator.onLine&&!r.url.includes("/playground.html")&&!r.url.includes("/setup.html")||r.url.startsWith("chrome://")||r.url.startsWith("chrome-extension://")&&!r.url.includes("/playground.html")&&!r.url.includes("/setup.html")||r.url.includes("stackoverflow.com/")||r.url.includes("chrome.google.com/webstore")||r.url.includes("chromewebstore.google.com")?chrome.tabs.create({url:"playground.html",active:!0}).then((function(t){chrome.storage.local.set({activeTab:t.id}),chrome.tabs.onUpdated.addListener((function t(e,r,n){e===n.id&&"complete"===r.status&&(setTimeout((function(){x(n.id,{type:"start-stream"})}),500),chrome.tabs.onUpdated.removeListener(t))}))})):x(r.id,{type:"start-stream"}),t.next=19;break;case 7:if("cancel-recording"!==e){t.next=14;break}return t.next=10,L();case 10:n=t.sent,x(n.id,{type:"cancel-recording"}),t.next=19;break;case 14:if("pause-recording"!=e){t.next=19;break}return t.next=17,L();case 17:o=t.sent,x(o.id,{type:"pause-recording"});case 19:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());var kr=function(){var t=pr(fr().mark((function t(e){var r,n,o,a,i,c;return fr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("recording-alarm"!==e.name){t.next=22;break}return t.next=3,chrome.storage.local.get(["recording"]);case 3:if(r=t.sent,!r.recording){t.next=21;break}return Sr(),t.next=9,chrome.storage.local.get(["recordingTab"]);case 9:return n=t.sent,o=n.recordingTab,x(o,{type:"stop-recording-tab"}),t.next=14,chrome.storage.local.get(["activeTab"]);case 14:return a=t.sent,i=a.activeTab,x(i,{type:"stop-recording-tab"}),t.next=19,L();case 19:c=t.sent,x(c.id,{type:"stop-recording-tab"});case 21:chrome.alarms.clear("recording-alarm");case 22:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Er=function(t){kr(t)},Lr=function(){chrome.alarms.onAlarm.hasListener(Er)||chrome.alarms.onAlarm.addListener(Er)};chrome.permissions&&chrome.permissions.contains({permissions:["alarms"]},(function(t){t&&Lr()}));var _r=function(){var t=pr(fr().mark((function t(e){var r,n,o,a,i,c,u,s,l,f,h,p,d,v,m,y,g,b,w,k;return fr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,chrome.storage.local.get(["recordingStartTime"]);case 2:return r=t.sent,n=r.recordingStartTime,t.next=6,chrome.tabs.get(e.tabId);case 6:return o=t.sent,t.next=9,chrome.storage.local.get(["recording"]);case 9:return a=t.sent,i=a.recording,t.next=13,chrome.storage.local.get(["restarting"]);case 13:if(c=t.sent,u=c.restarting,!i){t.next=32;break}return t.next=18,chrome.storage.local.get(["tabRecordedID"]);case 18:return s=t.sent,(l=s.tabRecordedID)&&l!==e.tabId?x(e.tabId,{type:"hide-popup-recording"}):o.url.includes("backup.html")&&o.url.includes("chrome-extension://")||chrome.storage.local.set({activeTab:e.tabId}),t.next=23,chrome.storage.local.get(["region"]);case 23:return f=t.sent,h=f.region,t.next=27,chrome.storage.local.get(["customRegion"]);case 27:p=t.sent,d=p.customRegion,h||d||x(e.tabId,{type:"recording-check"}),t.next=33;break;case 32:i||u||x(e.tabId,{type:"recording-ended"});case 33:if(!n){t.next=51;break}return t.next=36,chrome.storage.local.get(["alarm"]);case 36:if(v=t.sent,!v.alarm){t.next=49;break}return t.next=41,chrome.storage.local.get(["alarmTime"]);case 41:m=t.sent,y=m.alarmTime,g=parseFloat(y),b=Math.floor((Date.now()-n)/1e3),w=g-b,x(e.tabId,{type:"time",time:w}),t.next=51;break;case 49:k=Math.floor((Date.now()-n)/1e3),x(e.tabId,{type:"time",time:k});case 51:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();function Or(t){return new Promise((function(e,r){var n=new FileReader;n.onload=function(){e(n.result)},n.onerror=function(t){r(t)},n.readAsDataURL(t)}))}chrome.windows.onFocusChanged.addListener(function(){var t=pr(fr().mark((function t(e){var r,n,o;return fr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e!==chrome.windows.WINDOW_ID_NONE){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,chrome.tabs.query({active:!0,windowId:e});case 4:r=t.sent,n=ur(r,1),(o=n[0])&&_r({tabId:o.id});case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),chrome.tabs.onActivated.addListener(function(){var t=pr(fr().mark((function t(e){return fr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:_r(e);case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),chrome.tabs.onUpdated.addListener(function(){var t=pr(fr().mark((function t(e,r,n){var o,a,i,c,u,s,l,f,h,p,d,v,m,y,g,b;return fr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("complete"!==r.status){t.next=44;break}return t.next=3,chrome.storage.local.get(["recording"]);case 3:return o=t.sent,a=o.recording,t.next=7,chrome.storage.local.get(["restarting"]);case 7:return i=t.sent,c=i.restarting,t.next=11,chrome.storage.local.get(["tabRecordedID"]);case 11:return u=t.sent,s=u.tabRecordedID,a||c?a&&s&&s===e&&x(e,{type:"recording-check",force:!0}):x(e,{type:"recording-ended"}),t.next=16,chrome.storage.local.get(["recordingStartTime"]);case 16:return l=t.sent,f=l.recordingStartTime,t.next=20,chrome.tabs.get(e);case 20:if(h=t.sent,!f){t.next=39;break}return t.next=24,chrome.storage.local.get(["alarm"]);case 24:if(p=t.sent,!p.alarm){t.next=37;break}return t.next=29,chrome.storage.local.get(["alarmTime"]);case 29:d=t.sent,v=d.alarmTime,m=parseFloat(v),y=Math.floor((Date.now()-f)/1e3),x(e,{type:"time",time:m-y}),t.next=39;break;case 37:g=Math.floor((Date.now()-f)/1e3),x(e,{type:"time",time:g});case 39:return t.next=41,chrome.commands.getAll();case 41:b=t.sent,x(e,{type:"commands",commands:b}),h.url.includes(chrome.runtime.getURL("playground.html"))&&"complete"===r.status&&x(h.id,{type:"toggle-popup"});case 44:case"end":return t.stop()}}),t)})));return function(e,r,n){return t.apply(this,arguments)}}());var jr=function(){var t=pr(fr().mark((function t(e){var r,n,o,a,i,c,u,s,l,f,h,p=arguments;return fr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=p.length>1&&void 0!==p[1]&&p[1],t.next=3,chrome.storage.local.get(["sendingChunks","sandboxTab"]);case 3:if(n=t.sent,o=n.sendingChunks,a=n.sandboxTab,!o){t.next=9;break}return console.warn("Chunks are already being sent, skipping..."),t.abrupt("return");case 9:return t.next=11,chrome.storage.local.set({sendingChunks:!0});case 11:if(0!==e.length){t.next=16;break}return t.next=14,chrome.storage.local.set({sendingChunks:!1});case 14:return x(a,{type:"make-video-tab",override:r}),t.abrupt("return");case 16:e.sort((function(t,e){return t.timestamp-e.timestamp})),i=0,c=10,3,1e3,u=e.length,x(a,{type:"chunk-count",count:u,override:r}),s=function(){var t=pr(fr().mark((function t(e){var r,n=arguments;return fr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.length>1&&void 0!==n[1]?n[1]:0,t.prev=1,t.next=4,x(a,{type:"new-chunk-tab",chunks:e});case 4:if(t.sent){t.next=7;break}throw new Error("No response or failed response from tab.");case 7:t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),r<3?(console.error("Sending batch failed, retrying... Attempt ".concat(r+1),t.t0),setTimeout((function(){return s(e,r+1)}),1e3)):console.error("Maximum retry attempts reached for this batch.",t.t0);case 12:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(e){return t.apply(this,arguments)}}();case 24:if(!(i<u)){t.next=36;break}return l=Math.min(i+c,u),t.next=28,Promise.all(e.slice(i,l).map(function(){var t=pr(fr().mark((function t(e,r){var n;return fr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Or(e.chunk);case 3:return n=t.sent,t.abrupt("return",{chunk:n,index:i+r});case 7:return t.prev=7,t.t0=t.catch(0),console.error("Error converting chunk to Base64",t.t0),t.abrupt("return",null);case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e,r){return t.apply(this,arguments)}}()));case 28:if(f=t.sent,!((h=f.filter((function(t){return null!==t}))).length>0)){t.next=33;break}return t.next=33,s(h);case 33:i+=c,t.next=24;break;case 36:return t.next=38,chrome.storage.local.set({sendingChunks:!1});case 38:x(a,{type:"make-video-tab",override:r});case 39:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Tr=function(){var t=pr(fr().mark((function t(){var e,r,n=arguments;return fr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=n.length>0&&void 0!==n[0]&&n[0],t.prev=1,r=[],t.next=5,mr.iterate((function(t,e){r.push(t)}));case 5:jr(r,e),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(1),chrome.runtime.reload();case 11:case"end":return t.stop()}}),t,null,[[1,8]])})));return function(){return t.apply(this,arguments)}}(),Sr=function(){var t=pr(fr().mark((function t(){var e,r,n,o;return fr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return chrome.storage.local.set({restarting:!1}),t.next=3,chrome.storage.local.get(["recordingStartTime"]);case 3:return e=t.sent,r=e.recordingStartTime,n=Date.now()-r,42e4,0===r&&(n=0),chrome.storage.local.set({recording:!1,recordingDuration:n,tabRecordedID:null}),chrome.storage.local.set({recordingStartTime:0}),n>42e4?chrome.tabs.create({url:"editorfallback.html",active:!0},(function(t){chrome.tabs.onUpdated.addListener((function e(r,n,o){r===t.id&&"complete"===n.status&&(chrome.tabs.onUpdated.removeListener(e),chrome.storage.local.set({sandboxTab:t.id}),Tr())}))})):chrome.tabs.create({url:"editor.html",active:!0},(function(t){chrome.tabs.onUpdated.addListener((function e(r,n,o){r===t.id&&"complete"===n.status&&(chrome.tabs.onUpdated.removeListener(e),chrome.storage.local.set({sandboxTab:t.id}),Tr())}))})),chrome.action.setIcon({path:"assets/icon-34.png"}),t.next=14,chrome.storage.local.get(["wasRegion"]);case 14:o=t.sent,o.wasRegion&&chrome.storage.local.set({wasRegion:!1,region:!0}),chrome.alarms.clear("recording-alarm"),Cr();case 19:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),Pr=function(){var t=pr(fr().mark((function t(){var e,r,n;return fr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e="editor.html",t.next=3,chrome.storage.local.get(["sandboxTab"]);case 3:r=t.sent,n=r.sandboxTab,chrome.tabs.create({url:e,active:!0},(function(t){chrome.tabs.onUpdated.addListener((function e(r,o,a){r===t.id&&"complete"===o.status&&(chrome.tabs.onUpdated.removeListener(e),E(n),chrome.storage.local.set({sandboxTab:t.id}),Tr(!0))}))}));case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();chrome.runtime.onStartup.addListener((function(){console.log("Starting...")}));var Ar=function(){var t=pr(fr().mark((function t(){var e;return fr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,L();case 2:e=t.sent,x(e.id,{type:"ready-to-record"});case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),Ir=function(){var t=pr(fr().mark((function t(){var e,r,n,o,a,i,c,u;return fr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,chrome.storage.local.get(["micActive","defaultAudioInput","defaultAudioOutput","defaultVideoInput","systemAudio","recordingType","ReEvalProductionOption"]);case 2:return e=t.sent,r=e.micActive,n=e.defaultAudioInput,o=e.defaultAudioOutput,a=e.defaultVideoInput,i=e.systemAudio,c=e.recordingType,u=e.ReEvalProductionOption,t.abrupt("return",{micActive:r,defaultAudioInput:n,defaultAudioOutput:o,defaultVideoInput:a,systemAudio:i,recordingType:c,ReEvalProductionOption:u});case 11:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),Nr=function(){var t=pr(fr().mark((function t(){var e,r;return fr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return chrome.storage.local.set({restarting:!0}),t.next=3,chrome.storage.local.get(["region"]);case 3:return e=t.sent,e.region,t.next=7,chrome.storage.local.get(["wasRegion"]);case 7:r=t.sent,r.wasRegion&&chrome.storage.local.set({wasRegion:!1,region:!0}),chrome.action.setIcon({path:"assets/icon-34.png"});case 11:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),Dr=function(){var t=pr(fr().mark((function t(){return fr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:chrome.storage.local.set({restarting:!0}),"editor.html",navigator.userAgent.includes("Chrome/")&&parseInt(navigator.userAgent.match(/Chrome\/([0-9]+)/)[1],10)<=109&&"editorfallback.html",wr();case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),Rr=function(){var t=pr(fr().mark((function t(e){return fr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:chrome.storage.local.get(["recordingTab","offscreen"],(function(t){t.offscreen?chrome.runtime.sendMessage(e):x(t.recordingTab,e)}));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Gr=function(){var t=pr(fr().mark((function t(e,r){var n,o,a;return fr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,chrome.storage.local.get(["backupTab"]);case 2:n=t.sent,o=n.backupTab,a=chrome.runtime.getURL("backup.html"),o?chrome.tabs.get(o,(function(t){t?x(t.id,{type:"init-backup",request:e,tabId:r}):chrome.tabs.create({url:a,active:!0,pinned:!0,index:0},(function(t){chrome.storage.local.set({backupTab:t.id}),chrome.tabs.onUpdated.addListener((function n(o,a,i){o===t.id&&"complete"===a.status&&(x(t.id,{type:"init-backup",request:e,tabId:r}),chrome.tabs.onUpdated.removeListener(n))}))}))})):chrome.tabs.create({url:a,active:!0,pinned:!0,index:0},(function(t){chrome.storage.local.set({backupTab:t.id}),chrome.tabs.onUpdated.addListener((function n(o,a,i){o===t.id&&"complete"===a.status&&(x(t.id,{type:"init-backup",request:e,tabId:r}),chrome.tabs.onUpdated.removeListener(n))}))}));case 6:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}(),Fr=function(){var t=pr(fr().mark((function t(e){var r,n,o,a,i,c,u,s,l,f,h,p=arguments;return fr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=p.length>1&&void 0!==p[1]?p[1]:null,t.next=3,chrome.storage.local.get(["backup"]);case 3:return n=t.sent,o=n.backup,t.next=7,L();case 7:if(a=t.sent,null===r){t.next=12;break}return t.next=11,chrome.tabs.get(r);case 11:a=t.sent;case 12:return chrome.storage.local.set({activeTab:a.id,tabRecordedID:null,memoryError:!1}),a.url.includes(chrome.runtime.getURL("playground.html"))?chrome.storage.local.set({tabPreferred:!0}):chrome.storage.local.set({tabPreferred:!1}),t.prev=14,t.next=17,chrome.runtime.getContexts({});case 17:if(i=t.sent,!i.find((function(t){return"OFFSCREEN_DOCUMENT"===t.contextType}))){t.next=22;break}return t.next=22,chrome.offscreen.closeDocument();case 22:t.next=26;break;case 24:t.prev=24,t.t0=t.catch(14);case 26:if(!e.region){t.next=43;break}if(null!==r&&chrome.tabs.update(r,{active:!0}),chrome.storage.local.set({recordingTab:a.id,offscreen:!1,region:!0}),!e.customRegion){t.next=33;break}Rr({type:"loaded",request:e,backup:o,region:!0}),t.next=41;break;case 33:throw t.prev=33,new Error("Exit offscreen recording");case 37:t.prev=37,t.t1=t.catch(33),console.log("798->",t.t1),chrome.tabs.create({url:"recorder.html",pinned:!0,index:0,active:!!a.url.includes(chrome.runtime.getURL("playground.html"))}).then((function(t){chrome.storage.local.set({recordingTab:t.id,offscreen:!1,region:!1,wasRegion:!0,tabRecordedID:a.id}),chrome.tabs.onUpdated.addListener((function r(n,i,c){n===t.id&&"complete"===i.status&&(chrome.tabs.onUpdated.removeListener(r),Rr({type:"loaded",request:e,tabID:a.id,backup:o,isTab:!0}))}))}));case 41:t.next=74;break;case 43:if(t.prev=43,e.offscreenRecording&&!e.camera){t.next=46;break}throw new Error("Exit offscreen recording");case 46:return null!==r&&chrome.tabs.update(r,{active:!0}),t.next=49,chrome.storage.local.get(["qualityValue"]);case 49:return c=t.sent,u=c.qualityValue,t.next=53,chrome.storage.local.get(["fpsValue"]);case 53:return s=t.sent,l=s.fpsValue,t.next=57,chrome.runtime.getContexts({});case 57:if(f=t.sent,!f.find((function(t){return"OFFSCREEN_DOCUMENT"===t.contextType}))){t.next=62;break}return t.next=62,chrome.offscreen.closeDocument();case 62:return t.next=64,chrome.offscreen.createDocument({url:"recorderoffscreen.html",reasons:["USER_MEDIA","AUDIO_PLAYBACK","DISPLAY_MEDIA"],justification:"Recording from getDisplayMedia API"});case 64:chrome.storage.local.set({recordingTab:null,offscreen:!0,region:!1,wasRegion:!1}),Rr({type:"loaded",request:e,isTab:!1,quality:u,fps:l,backup:o}),t.next=74;break;case 68:t.prev=68,t.t2=t.catch(43),console.log("798->",t.t2),h=!0,e.camera&&(h=!1),chrome.tabs.create({url:"recorder.html",pinned:!0,index:0,active:h}).then((function(t){chrome.storage.local.set({recordingTab:t.id,offscreen:!1,region:!1,wasRegion:!1}),chrome.tabs.onUpdated.addListener((function r(n,a,i){n===t.id&&"complete"===a.status&&(chrome.tabs.onUpdated.removeListener(r),Rr({type:"loaded",request:e,backup:o}))}))}));case 74:case"end":return t.stop()}}),t,null,[[14,24],[33,37],[43,68]])})));return function(e){return t.apply(this,arguments)}}(),Ur=function(){var t=pr(fr().mark((function t(){var e,r;return fr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,chrome.storage.local.get(["sandboxTab"]);case 2:e=t.sent,r=e.sandboxTab,x(r,{type:"saved-to-drive"});case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),Cr=function(){var t=pr(fr().mark((function t(){var e;return fr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,chrome.runtime.getContexts({});case 3:if(e=t.sent,!e.find((function(t){return"OFFSCREEN_DOCUMENT"===t.contextType}))){t.next=8;break}return t.next=8,chrome.offscreen.closeDocument();case 8:t.next=12;break;case 10:t.prev=10,t.t0=t.catch(0);case 12:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(){return t.apply(this,arguments)}}(),Mr=function(){var t=pr(fr().mark((function t(){var e,r,n,o,a,i,c,u,s,l,f;return fr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=chrome.runtime.getManifest().content_scripts,r=e.map((function(t){return chrome.tabs.query({url:t.matches})})),t.next=4,Promise.all(r);case 4:for(n=t.sent,o=[],a=0;a<n.length;a++){i=n[a],c=e[a],u=cr(i);try{for(u.s();!(s=u.n()).done;)l=s.value,f=chrome.scripting.executeScript({target:{tabId:l.id},files:c.js},(function(){return chrome.runtime.lastError})),o.push(f)}catch(t){u.e(t)}finally{u.f()}}return t.next=9,Promise.all(o);case 9:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();chrome.runtime.onInstalled.addListener(function(){var t=pr(fr().mark((function t(e){var r,n,o,a;return fr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"install"===e.reason?(chrome.storage.local.clear(),(r=chrome.i18n.getMessage("@@ui_locale")).includes("en")?chrome.runtime.setUninstallURL("https://tally.so/r/w8Zro5?version="+chrome.runtime.getManifest().version):chrome.runtime.setUninstallURL("http://translate.google.com/translate?js=n&sl=auto&tl="+r+"&u=https://tally.so/r/w8Zro5?version="+chrome.runtime.getManifest().version),chrome.storage.local.set({firstTime:!0}),chrome.tabs.create({url:"setup.html"})):"update"===e.reason&&("2.8.6"===e.previousVersion?(chrome.storage.local.clear(),chrome.storage.local.set({updatingFromOld:!0})):chrome.storage.local.set({updatingFromOld:!1}),(n=chrome.i18n.getMessage("@@ui_locale")).includes("en")?chrome.runtime.setUninstallURL("https://tally.so/r/3Ex6kX?version="+chrome.runtime.getManifest().version):chrome.runtime.setUninstallURL("http://translate.google.com/translate?js=n&sl=auto&tl="+n+"&u=https://tally.so/r/3Ex6kX?version="+chrome.runtime.getManifest().version)),navigator.userAgent.includes("Chrome/")&&parseInt(navigator.userAgent.match(/Chrome\/([0-9]+)/)[1],10)<=109&&chrome.storage.local.set({backup:!1}),chrome.storage.local.set({systemAudio:!0}),t.next=5,chrome.storage.local.get(["backupTab"]);case 5:o=t.sent,(a=o.backupTab)&&E(a),Mr();case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),chrome.tabs.onRemoved.addListener(function(){var t=pr(fr().mark((function t(e,r){var n,o,a,i,c,u,s,l,f;return fr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,chrome.storage.local.get(["region"]);case 2:if(n=t.sent,!n.region){t.next=6;break}return t.abrupt("return");case 6:return t.next=8,chrome.storage.local.get(["recordingTab"]);case 8:return o=t.sent,a=o.recordingTab,t.next=12,chrome.storage.local.get(["recording"]);case 12:return i=t.sent,c=i.recording,t.next=16,chrome.storage.local.get(["restarting"]);case 16:if(u=t.sent,s=u.restarting,e!==a||s){t.next=26;break}return chrome.storage.local.set({recordingTab:null}),t.next=22,chrome.storage.local.get(["activeTab"]);case 22:l=t.sent,f=l.activeTab;try{c&&k(f),x(f,{type:"stop-recording-tab"},null,(function(){x(e,{type:"stop-recording-tab"}),chrome.storage.local.set({activeTab:e})}))}catch(t){x(e,{type:"stop-recording-tab"}),chrome.storage.local.set({activeTab:e})}chrome.action.setIcon({path:"assets/icon-34.png"});case 26:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}());var qr=function(){var t=pr(fr().mark((function t(){return fr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:Rr({type:"dismiss-recording"}),chrome.action.setIcon({path:"assets/icon-34.png"}),Cr(),chrome.storage.local.set({recordingTab:null,sandboxTab:null,recording:!1}),chrome.runtime.sendMessage({type:"discard-backup"});case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),Br=function(){var t=pr(fr().mark((function t(){var e,r,n,o,a;return fr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,chrome.storage.local.get(["recordingTab"]);case 2:return e=t.sent,r=e.recordingTab,t.next=6,chrome.storage.local.get(["offscreen"]);case 6:if(n=t.sent,o=n.offscreen,!r||o){t.next=12;break}try{chrome.tabs.get(r,(function(t){t||qr()}))}catch(t){qr()}t.next=18;break;case 12:if(!o){t.next=18;break}return t.next=15,chrome.runtime.getContexts({});case 15:a=t.sent,a.find((function(t){return"OFFSCREEN_DOCUMENT"===t.contextType}))||qr();case 18:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),Yr=function(){var t=pr(fr().mark((function t(){return fr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:wr();case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),Vr=function(){var t=pr(fr().mark((function t(e,r){return fr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:chrome.tabs.create({url:"download.html",active:!1},(function(t){chrome.tabs.onUpdated.addListener((function n(o,a,i){o===t.id&&"complete"===a.status&&(chrome.tabs.onUpdated.removeListener(n),x(t.id,{type:"download-video",base64:e,title:r}))}))}));case 1:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}(),zr=function(){var t=pr(fr().mark((function t(){return fr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:chrome.tabs.create({url:"download.html",active:!1},(function(t){chrome.tabs.onUpdated.addListener((function e(r,n,o){r===t.id&&"complete"===n.status&&(chrome.tabs.onUpdated.removeListener(e),x(t.id,{type:"download-indexed-db"}))}))}));case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),Wr=function(){var t=pr(fr().mark((function t(){var e,r;return fr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e="editorfallback.html",navigator.userAgent.includes("Chrome/")&&parseInt(navigator.userAgent.match(/Chrome\/([0-9]+)/)[1],10)<=109&&(e="editorfallback.html"),r=[],t.next=5,mr.iterate((function(t,e){r.push(t)}));case 5:if(0!==r.length){t.next=7;break}return t.abrupt("return");case 7:chrome.tabs.create({url:e,active:!0},function(){var t=pr(fr().mark((function t(e){return fr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return chrome.storage.local.set({sandboxTab:e.id}),t.next=3,new Promise((function(t){chrome.tabs.onUpdated.addListener((function(t,r){"complete"===r.status&&t===e.id&&(x(e.id,{type:"restore-recording"}),Tr())}))}));case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),Hr=function(){var t=pr(fr().mark((function t(e){var r;return fr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=[],t.next=3,mr.iterate((function(t,e){r.push(t)}));case 3:if(0!==r.length){t.next=6;break}return e({restore:!1,chunks:[]}),t.abrupt("return");case 6:e({restore:!0});case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Jr=function(t){var e=t.match(/^data:(.*?);base64,/);if(null!==e){for(var r=e[1],n=atob(t.slice(e[0].length)),o=new Uint8Array(n.length),a=0;a<n.length;a++)o[a]=n.charCodeAt(a);return new Blob([o],{type:r})}for(var i=atob(t),c=new Uint8Array(i.length),u=0;u<i.length;u++)c[u]=i.charCodeAt(u);return new Blob([c],{type:"video/webm"})},Xr=function(){var t=pr(fr().mark((function t(e,r){var n,o,a,i,c,u,s,l,h,p,d=arguments;return fr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(d.length>2&&void 0!==d[2]&&d[2]){t.next=7;break}n=Jr(r.base64),o=r.title+".mp4",f(n,o,e).then((function(){Ur()})),t.next=25;break;case 7:return a=[],t.next=10,mr.iterate((function(t,e){a.push(t)}));case 10:i=[],c=0,u=0,s=a;case 13:if(!(u<s.length)){t.next=22;break}if(!((l=s[u]).timestamp<c)){t.next=17;break}return t.abrupt("continue",19);case 17:c=l.timestamp,i.push(l.chunk);case 19:u++,t.next=13;break;case 22:h=new Blob(i,{type:"video/webm"}),p=r.title+".webm",f(h,p,e).then((function(){Ur()}));case 25:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}(),$r=function(){var t=pr(fr().mark((function t(e){var r,n,o,a,i;return fr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,chrome.storage.local.get(["backup"]);case 2:return r=t.sent,n=r.backup,t.next=6,chrome.storage.local.get(["backupSetup"]);case 6:if(o=t.sent,a=o.backupSetup,chrome.storage.local.set({sendingChunks:!1}),!n){t.next=17;break}return a||yr.clear(),t.next=13,L();case 13:i=t.sent,Gr(e,i.id),t.next=18;break;case 17:Fr(e);case 18:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Kr=function(){var t=pr(fr().mark((function t(e){var r,n;return fr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,chrome.storage.local.get(["backupTab"]);case 2:r=t.sent,(n=r.backupTab)?x(n,{type:"write-file",index:e.index},null,(function(){Rr({type:"stop-recording-tab"})})):Rr({type:"stop-recording-tab"});case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Zr=function(){var t=pr(fr().mark((function t(){var e,r;return fr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,chrome.storage.local.get(["backupTab"]);case 2:e=t.sent,(r=e.backupTab)&&x(r,{type:"close-writable"}),Sr();case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),Qr=function(){var t=pr(fr().mark((function t(e,r){var n,o;return fr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,chrome.storage.local.get(["sandboxTab"]);case 2:n=t.sent,o=n.sandboxTab,x(o,{type:"new-chunk-tab",chunk:e.chunk,index:e.index}),r({status:"ok"});case 6:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}(),tn=function(){var t=pr(fr().mark((function t(){var e;return fr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Ir();case 2:e=t.sent,Rr({type:"streaming-data",data:JSON.stringify(e)});case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),en=function(){var t=pr(fr().mark((function t(){var e,r;return fr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return chrome.action.setIcon({path:"assets/icon-34.png"}),t.next=3,chrome.storage.local.get(["activeTab"]);case 3:e=t.sent,r=e.activeTab,x(r,{type:"stop-pending"}),k(r),Cr();case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),rn=function(){var t=pr(fr().mark((function t(e){return fr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.memoryError&&chrome.storage.local.set({recording:!1,restarting:!1,tabRecordedID:null,memoryError:!0}),Rr({type:"stop-recording-tab"});case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),nn=function(){var t=pr(fr().mark((function t(){return fr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),on=function(){var t=pr(fr().mark((function t(){return fr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:chrome.runtime.sendMessage({type:"discard-backup"}),qr();case 2:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),an=function(){var t=pr(fr().mark((function t(e){return fr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:chrome.storage.local.get(["region"],(function(t){t.region&&Rr({type:"set-mic-active-tab",active:e.active,defaultAudioInput:e.defaultAudioInput})}));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),cn=function(){var t=pr(fr().mark((function t(e){var r,n,o,a,i,c;return fr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,chrome.storage.local.get(["activeTab"]);case 2:return r=t.sent,n=r.activeTab,Rr({type:"recording-error"}).then((function(){x(n,{type:"stop-pending"}),k(n),"stream-error"===e.error?x(n,{type:"stream-error"}):"backup-error"===e.error&&x(n,{type:"backup-error"})})),t.next=7,chrome.storage.local.get(["recordingTab"]);case 7:return o=t.sent,a=o.recordingTab,t.next=11,chrome.storage.local.get(["region"]);case 11:i=t.sent,c=i.region,a&&!c&&E(a),chrome.storage.local.set({recordingTab:null}),Cr();case 16:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),un=function(){var t=pr(fr().mark((function t(e){var r;return fr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,L();case 2:(r=t.sent)&&x(r.id,{type:"on-get-permissions",data:e});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),sn=function(){var t=pr(fr().mark((function t(){var e,r;return fr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,chrome.storage.local.get(["recordingTab"]);case 2:e=t.sent,(r=e.recordingTab)&&chrome.tabs.get(r,(function(t){t&&t.url.includes("chrome-extension")&&t.url.includes("recorder.html")&&E(r)}));case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),ln=function(){var t=pr(fr().mark((function t(e){var r,n;return fr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return chrome.storage.local.set({surface:e.surface}),t.next=3,chrome.storage.local.get(["activeTab"]);case 3:r=t.sent,n=r.activeTab,x(n,{type:"set-surface",surface:e.surface});case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),fn=function(){var t=pr(fr().mark((function t(){var e,r,n,o=arguments;return fr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=o.length>0&&void 0!==o[0]&&o[0],t.next=3,chrome.storage.local.get(["activeTab"]);case 3:r=t.sent,n=r.activeTab,x(n,e?{type:"pip-started"}:{type:"pip-ended"});case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),hn=function(){var t=pr(fr().mark((function t(){var e,r;return fr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,chrome.storage.local.get(["token"]);case 2:e=t.sent,r=e.token,fetch("https://accounts.google.com/o/oauth2/revoke?token="+r),chrome.identity.removeCachedAuthToken({token:r}),chrome.storage.local.set({token:!1});case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),pn=function(){var t=pr(fr().mark((function t(e){var r,n;return fr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return chrome.storage.local.set({recording:!1,restarting:!1,tabRecordedID:null,memoryError:!0}),Rr({type:"stop-recording-tab"}),t.next=4,chrome.storage.local.get(["activeTab"]);case 4:r=t.sent,n=r.activeTab,x(n,{type:"stop-pending"}),k(n);case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),dn=function(){var t=pr(fr().mark((function t(){return fr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:mr.clear();case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),vn=function(){var t=pr(fr().mark((function t(e,r){return fr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(0!==e&&0!==r){t.next=2;break}return t.abrupt("return");case 2:chrome.windows.getCurrent((function(t){chrome.windows.update(t.id,{width:e,height:r})}));case 3:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}();function mn(t,e){var r=new URL(t);return r.searchParams.set("reeval",e),r.toString()}chrome.runtime.onMessage.addListener((function(t,e,r){if("desktop-capture"===t.type)$r(t);else if("backup-created"===t.type)Fr(t.request,t.tabId);else if("write-file"===t.type)Kr(t);else if("handle-restart"===t.type)Dr();else if("handle-dismiss"===t.type)Nr();else if("reset-active-tab"===t.type)br();else if("reset-active-tab-restart"===t.type)wr();else if("start-rec"===t.type)xr();else if("video-ready"===t.type)Zr();else if("start-recording"===t.type)xr();else if("restarted"===t.type)Ar();else{if("new-chunk"===t.type)return Qr(t,r),!0;if("get-streaming-data"===t.type)tn();else if("cancel-recording"===t.type)en();else if("stop-recording-tab"===t.type)rn(t);else if("restart-recording-tab"===t.type)nn();else if("dismiss-recording-tab"===t.type)on();else if("pause-recording-tab"===t.type)Rr({type:"pause-recording-tab"});else if("resume-recording-tab"===t.type)Rr({type:"resume-recording-tab"});else if("set-mic-active-tab"===t.type)an(t);else if("recording-error"===t.type)cn(t);else if("on-get-permissions"===t.type)un(t);else if("recording-complete"===t.type)sn();else if("check-recording"===t.type)Br();else if("review-screenity"===t.type)_("https://chrome.google.com/webstore/detail/screenity-screen-recorder/kbbdabhdfibnancpjfhlkhafgdilcnji/reviews",!1,!0);else if("follow-twitter"===t.type)_("https://alyssax.substack.com/",!1,!0);else if("open-processing-info"===t.type)_("https://help.screenity.io/editing-and-exporting/dJRFpGq56JFKC7k8zEvsqb/why-is-there-a-5-minute-limit-for-editing/ddy4e4TpbnrFJ8VoRT37tQ",!0,!0);else if("upgrade-info"===t.type)_("https://help.screenity.io/getting-started/77KizPC8MHVGfpKpqdux9D/what-are-the-technical-requirements-for-using-screenity/6kdB6qru6naVD8ZLFvX3m9",!0,!0);else if("trim-info"===t.type)_("https://help.screenity.io/editing-and-exporting/dJRFpGq56JFKC7k8zEvsqb/how-to-cut-trim-or-mute-parts-of-your-video/svNbM7YHYY717MuSWXrKXH",!0,!0);else if("join-waitlist"===t.type)_("https://tally.so/r/npojNV",!0,!0);else if("chrome-update-info"===t.type)_("https://help.screenity.io/getting-started/77KizPC8MHVGfpKpqdux9D/what-are-the-technical-requirements-for-using-screenity/6kdB6qru6naVD8ZLFvX3m9",!0,!0);else if("set-surface"===t.type)ln(t);else if("pip-ended"===t.type)fn(!1);else if("pip-started"===t.type)fn(!0);else if("new-sandbox-page-restart"===t.type)Yr();else if("sign-out-drive"===t.type)hn();else if("open-help"===t.type)_("https://help.screenity.io/",!0,!0);else if("memory-limit-help"===t.type)_("https://help.screenity.io/troubleshooting/9Jy5RGjNrBB42hqUdREQ7W/what-does-%E2%80%9Cmemory-limit-reached%E2%80%9D-mean-when-recording/8WkwHbt3puuXunYqQnyPcb",!0,!0);else if("open-home"===t.type)_("https://screenity.io/",!1,!0);else if("report-bug"===t.type)_("https://tally.so/r/3ElpXq?version="+chrome.runtime.getManifest().version,!1,!0);else if("clear-recordings"===t.type)dn();else if("force-processing"===t.type)Pr();else if("focus-this-tab"===t.type)k(e.tab.id);else if("stop-recording-tab-backup"===t.type)pn(t);else if("indexed-db-download"===t.type)zr();else{if("get-platform-info"===t.type)return function(t){chrome.runtime.getPlatformInfo((function(e){t(e)}))}(r),!0;if("restore-recording"===t.type)Wr();else{if("check-restore"===t.type)return Hr(r),!0;if("check-capture-permissions"===t.type)return chrome.permissions.contains({permissions:["desktopCapture","alarms","offscreen"]},(function(t){t?r({status:"ok"}):chrome.permissions.request({permissions:["desktopCapture","alarms","offscreen"]},(function(t){t?(Lr(),r({status:"ok"})):r({status:"error"})}))})),!0;if("is-pinned"===t.type)return function(t){chrome.action.getUserSettings().then((function(e){t({pinned:e.isOnToolbar})}))}(r),!0;if("save-to-drive"===t.type)return Xr(r,t,!1),!0;if("save-to-drive-fallback"===t.type)return Xr(r,t,!0),!0;if("request-download"===t.type)Vr(t.base64,t.title);else if("resize-window"===t.type)vn(t.width,t.height);else{if("available-memory"===t.type)return function(t){navigator.storage.estimate().then((function(e){t({data:e})}))}(r),!0;"extension-media-permissions"===t.type?_("chrome://settings/content/siteDetails?site=chrome-extension://"+chrome.runtime.id,!1,!0):"add-alarm-listener"===t.type&&Lr()}}}}})),chrome.runtime.onMessage.addListener(function(){var t=pr(fr().mark((function t(e,r,n){var o,a,i,c,u,s,l,f,h,p,d,v,m,y,g,b,w,x,k,E,_,O,j,T,S,I,N,D,R,G,F,C,q,B,Y,V,z,W,H,J,X,$,K,Z,Q,tt,et;return fr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=e.type,a=e.options,"reeval"!==o){t.next=82;break}return i=new Map,c=[],u=a.map((function(t,e){var r=mn(t.target,e);return ar(ar({},t),{},{url:r})})),t.next=7,A(1e4);case 7:t.prev=7,s=!1,l=!1,t.prev=10,h=fr().mark((function t(){var e,r,n,o,a;return fr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=d.value,n=e.url,e.inx,t.next=4,chrome.tabs.query({url:n});case 4:if(o=t.sent,a=null==o?void 0:o[0],null!=o&&o.length){t.next=12;break}return Number(new Date),t.next=10,chrome.tabs.create({url:n,active:!1});case 10:a=t.sent,c.push(new Promise((function(t){chrome.tabs.onUpdated.addListener((function e(r,n){"complete"===n.status&&r===a.id&&(chrome.tabs.onUpdated.removeListener(e),t(!0))}))})));case 12:i.set(n,null===(r=a)||void 0===r?void 0:r.id);case 13:case"end":return t.stop()}}),t)})),p=dr(u);case 13:return t.next=15,p.next();case 15:if(!(s=!(d=t.sent).done)){t.next=20;break}return t.delegateYield(h(),"t0",17);case 17:s=!1,t.next=13;break;case 20:t.next=26;break;case 22:t.prev=22,t.t1=t.catch(10),l=!0,f=t.t1;case 26:if(t.prev=26,t.prev=27,!s||null==p.return){t.next=31;break}return t.next=31,p.return();case 31:if(t.prev=31,!l){t.next=34;break}throw f;case 34:return t.finish(31);case 35:return t.finish(26);case 36:return t.next=38,Promise.all(c);case 38:return t.next=40,A(2e3);case 40:v=!1,m=!1,t.prev=42,g=dr(u);case 44:return t.next=46,g.next();case 46:if(!(v=!(b=t.sent).done)){t.next=61;break}return w=b.value,x=w.url,k=i.get(x),t.next=52,chrome.tabs.update(k,{highlighted:!0});case 52:return t.next=54,chrome.tabs.sendMessage(k,{type:"run-reeval",options:w});case 54:return t.next=56,A(P(w.time_end).diff(P(w.time_start)));case 56:return t.next=58,chrome.tabs.update(k,{highlighted:!1});case 58:v=!1,t.next=44;break;case 61:t.next=67;break;case 63:t.prev=63,t.t2=t.catch(42),m=!0,y=t.t2;case 67:if(t.prev=67,t.prev=68,!v||null==g.return){t.next=72;break}return t.next=72,g.return();case 72:if(t.prev=72,!m){t.next=75;break}throw y;case 75:return t.finish(72);case 76:return t.finish(67);case 77:t.next=82;break;case 79:t.prev=79,t.t3=t.catch(7),console.error(t.t3);case 82:if("reeval-storyboard"!==o){t.next=128;break}return E=a.storyboard,_=E.sections,t.next=87,U(chrome.windows.WindowState.FULLSCREEN);case 87:O=t.sent,j=[],T=!1,S=!1,t.prev=91,N=fr().mark((function t(){var e,r,n,o,a,i,c;return fr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=ur(R.value,2),r=e[0],n=e[1],a=null==n||null===(o=n.screen_recording)||void 0===o?void 0:o.url,n.inx=r,!a){t.next=11;break}return i=mn(a,r),t.next=7,chrome.tabs.create({url:i,active:!r,windowId:O.id});case 7:c=t.sent,n.tabId=c.id,n.url=i,j.push(new Promise((function(t){chrome.tabs.onUpdated.addListener((function e(r,n){"complete"===n.status&&r===c.id&&(chrome.tabs.onUpdated.removeListener(e),t(!0))}))})));case 11:case"end":return t.stop()}}),t)})),D=dr(Object.entries(_));case 94:return t.next=96,D.next();case 96:if(!(T=!(R=t.sent).done)){t.next=101;break}return t.delegateYield(N(),"t4",98);case 98:T=!1,t.next=94;break;case 101:t.next=107;break;case 103:t.prev=103,t.t5=t.catch(91),S=!0,I=t.t5;case 107:if(t.prev=107,t.prev=108,!T||null==D.return){t.next=112;break}return t.next=112,D.return();case 112:if(t.prev=112,!S){t.next=115;break}throw I;case 115:return t.finish(112);case 116:return t.finish(107);case 117:return j.push(M(O.id)),t.next=120,Promise.all(j);case 120:return t.next=122,L({windowId:O.id});case 122:return G=t.sent,console.log(G),t.next=126,chrome.storage.local.set({activeTab:G.id});case 126:return t.next=128,chrome.tabs.sendMessage(G.id,{type:"reeval-start-recording",options:a});case 128:if("reeval-run-storyboard"!==o){t.next=188;break}return t.prev=129,console.log("reeval-run-storyboard --\x3e> ",a),t.next=133,A(3e3);case 133:q=null!==(F=null==a||null===(C=a.storyboard)||void 0===C?void 0:C.sections)&&void 0!==F?F:[],B=!1,Y=!1,t.prev=136,z=dr(q);case 138:return t.next=140,z.next();case 140:if(!(B=!(W=t.sent).done)){t.next=157;break}if(H=W.value,J=H.tabId,X=H.inx,$=H.screen_recording,!J){t.next=154;break}return t.next=146,chrome.tabs.update(J,{highlighted:!0});case 146:return t.next=148,chrome.tabs.sendMessage(J,{type:"run-reeval",options:$});case 148:return Z=null!==(K=null==$?void 0:$.duration)&&void 0!==K?K:5e3,console.log(X,"---\x3e>>",null==$?void 0:$.duration),t.next=152,A(Z);case 152:return t.next=154,chrome.tabs.update(J,{highlighted:!1});case 154:B=!1,t.next=138;break;case 157:t.next=163;break;case 159:t.prev=159,t.t6=t.catch(136),Y=!0,V=t.t6;case 163:if(t.prev=163,t.prev=164,!B||null==z.return){t.next=168;break}return t.next=168,z.return();case 168:if(t.prev=168,!Y){t.next=171;break}throw V;case 171:return t.finish(168);case 172:return t.finish(163);case 173:return t.next=175,chrome.runtime.sendMessage({type:"stop-recording-tab"});case 175:return t.next=177,chrome.windows.getCurrent();case 177:return Q=t.sent,tt=Q.id,t.next=181,chrome.windows.update(tt,{state:chrome.windows.WindowState.MINIMIZED});case 181:return t.next=183,chrome.windows.update(tt,{state:chrome.windows.WindowState.MAXIMIZED});case 183:t.next=188;break;case 185:t.prev=185,t.t7=t.catch(129),console.log("reeval-run-storyboard",t.t7);case 188:if("reeval-start-recording-test"!==o){t.next=194;break}return t.next=191,L();case 191:return et=t.sent,t.next=194,chrome.tabs.sendMessage(et.id,{type:"toggle-popup"});case 194:case"end":return t.stop()}}),t,null,[[7,79],[10,22,26,36],[27,,31,35],[42,63,67,77],[68,,72,76],[91,103,107,117],[108,,112,116],[129,185],[136,159,163,173],[164,,168,172]])})));return function(e,r,n){return t.apply(this,arguments)}}())}},(function(t){t.h=()=>"c6133a01e0a8d019369c"}));
//# sourceMappingURL=471.bde21d9cb474cea7dcb1.hot-update.js.map